{"version":3,"sources":["../../../../../src/javascripts/ng-admin/Crud/list/maDatagridInfinitePagination.js"],"names":["maDatagridInfinitePagination","$window","$document","windowElement","element","offset","body","restrict","scope","perPage","totalItems","nextPage","link","parseInt","nbPages","Math","ceil","page","loadedPages","handler","offsetHeight","innerHeight","scrollY","push","bind","$on","destroy","unbind","$inject"],"mappings":";;;;;kBAEwBA,4B;;AAFxB;;;;;;AAEe,SAASA,4BAAT,CAAsCC,OAAtC,EAA+CC,SAA/C,EAA0D;;AAErE,QAAIC,gBAAgB,kBAAQC,OAAR,CAAgBH,OAAhB,CAApB;AACA,QAAII,SAAS,GAAb;AAAA,QACIC,OAAOJ,UAAU,CAAV,EAAaI,IADxB;;AAGA,WAAO;AACHC,kBAAU,GADP;AAEHC,eAAO;AACHC,qBAAS,GADN;AAEHC,wBAAY,GAFT;AAGHC,sBAAU;AAHP,SAFJ;AAOHC,cAAM,cAASJ,KAAT,EAAgB;AAClB,gBAAIC,UAAUI,SAASL,MAAMC,OAAf,EAAwB,EAAxB,KAA+B,CAA7C;AAAA,gBACIC,aAAaG,SAASL,MAAME,UAAf,EAA2B,EAA3B,CADjB;AAAA,gBAEII,UAAUC,KAAKC,IAAL,CAAUN,aAAaD,OAAvB,KAAmC,CAFjD;AAAA,gBAGIQ,OAAO,CAHX;AAAA,gBAIIC,cAAc,EAJlB;AAKA,qBAASC,OAAT,GAAmB;AACf,oBAAIb,KAAKc,YAAL,GAAoBnB,QAAQoB,WAA5B,GAA0CpB,QAAQqB,OAAlD,GAA4DjB,MAAhE,EAAwE;AACpE,wBAAIY,QAAQH,OAAZ,EAAqB;AACjB;AACH;AACDG;AACA,wBAAGA,QAAQC,WAAX,EAAuB;AACnB;AACH;AACDA,gCAAYK,IAAZ,CAAiBN,IAAjB;AACAT,0BAAMG,QAAN,GAAiBM,IAAjB;AACH;AACJ;AACDd,0BAAcqB,IAAd,CAAmB,QAAnB,EAA6BL,OAA7B;AACAX,kBAAMiB,GAAN,CAAU,UAAV,EAAsB,SAASC,OAAT,GAAmB;AACrCvB,8BAAcwB,MAAd,CAAqB,QAArB,EAA+BR,OAA/B;AACH,aAFD;AAGH;AA9BE,KAAP;AAgCH;;AAEDnB,6BAA6B4B,OAA7B,GAAuC,CAAC,SAAD,EAAY,WAAZ,CAAvC","file":"maDatagridInfinitePagination.js","sourcesContent":["import angular from 'angular';\n\nexport default function maDatagridInfinitePagination($window, $document) {\n\n    var windowElement = angular.element($window);\n    var offset = 100,\n        body = $document[0].body;\n\n    return {\n        restrict: 'E',\n        scope: {\n            perPage: '@',\n            totalItems: '@',\n            nextPage: '&'\n        },\n        link: function(scope) {\n            var perPage = parseInt(scope.perPage, 10) || 1,\n                totalItems = parseInt(scope.totalItems, 10),\n                nbPages = Math.ceil(totalItems / perPage) || 1,\n                page = 1,\n                loadedPages = [];\n            function handler() {\n                if (body.offsetHeight - $window.innerHeight - $window.scrollY < offset) {\n                    if (page >= nbPages) {\n                        return;\n                    }\n                    page++;\n                    if(page in loadedPages){\n                        return;\n                    }\n                    loadedPages.push(page);\n                    scope.nextPage()(page);\n                }\n            }\n            windowElement.bind('scroll', handler);\n            scope.$on('$destroy', function destroy() {\n                windowElement.unbind('scroll', handler);\n            });\n        }\n    };\n}\n\nmaDatagridInfinitePagination.$inject = ['$window', '$document'];\n"]}