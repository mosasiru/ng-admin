{"version":3,"sources":["../../../../../src/javascripts/ng-admin/Crud/field/maDateField.js"],"names":["maDateField","scope","restrict","link","element","field","name","rawValue","value","Date","$watch","newValue","parse","oldValue","format","type","v","validation","isOpen","input","find","eq","attributes","attr","toggleDatePicker","$event","preventDefault","stopPropagation","template","$inject"],"mappings":";;;;;kBAKwBA,W;AALxB;;;;;AAKe,SAASA,WAAT,GAAuB;AAClC,WAAO;AACHC,eAAO;AACH,qBAAS,GADN;AAEH,qBAAS;AAFN,SADJ;AAKHC,kBAAU,GALP;AAMHC,cAAM,cAASF,KAAT,EAAgBG,OAAhB,EAAyB;AAC3B,gBAAIC,QAAQJ,MAAMI,KAAN,EAAZ;AACAJ,kBAAMK,IAAN,GAAaD,MAAMC,IAAN,EAAb;AACAL,kBAAMM,QAAN,GAAiBN,MAAMO,KAAN,IAAe,IAAf,GAAsB,IAAtB,GAA8BP,MAAMO,KAAN,YAAuBC,IAAvB,GAA8BR,MAAMO,KAApC,GAA4C,IAAIC,IAAJ,CAASR,MAAMO,KAAf,CAA3F;;AAEAP,kBAAMS,MAAN,CAAa,UAAb,EAAyB,UAASC,QAAT,EAAmB;AACxCV,sBAAMO,KAAN,GAAcH,MAAMO,KAAN,GAAcD,QAAd,CAAd;AACH,aAFD;;AAIAV,kBAAMS,MAAN,CAAa,OAAb,EAAsB,UAACC,QAAD,EAAWE,QAAX,EAAwB;AAC1C,oBAAIF,aAAaE,QAAjB,EAA2B;AACvB;AACH;;AAED,oBAAI,CAACF,QAAL,EAAe;AACXV,0BAAMM,QAAN,GAAiB,IAAjB;AACA;AACH;;AAEDN,sBAAMM,QAAN,GAAiBN,MAAMO,KAAN,YAAuBC,IAAvB,GAA8BR,MAAMO,KAApC,GAA4C,IAAIC,IAAJ,CAASR,MAAMO,KAAf,CAA7D;AACH,aAXD;;AAaAP,kBAAMa,MAAN,GAAeT,MAAMS,MAAN,EAAf;AACA,gBAAI,CAACb,MAAMa,MAAX,EAAmB;AACfb,sBAAMa,MAAN,GAAeT,MAAMU,IAAN,OAAiB,MAAjB,GAA0B,YAA1B,GAAyC,qBAAxD;AACH;;AAEDd,kBAAMe,CAAN,GAAUX,MAAMY,UAAN,EAAV;AACAhB,kBAAMiB,MAAN,GAAe,KAAf;AACA,gBAAIC,QAAQf,QAAQgB,IAAR,CAAa,OAAb,EAAsBC,EAAtB,CAAyB,CAAzB,CAAZ;AACA,gBAAIC,aAAajB,MAAMiB,UAAN,EAAjB;AACA,iBAAK,IAAIhB,IAAT,IAAiBgB,UAAjB,EAA6B;AACzBH,sBAAMI,IAAN,CAAWjB,IAAX,EAAiBgB,WAAWhB,IAAX,CAAjB;AACH;AACDL,kBAAMuB,gBAAN,GAAyB,UAAUC,MAAV,EAAkB;AACvCA,uBAAOC,cAAP;AACAD,uBAAOE,eAAP;AACA1B,sBAAMiB,MAAN,GAAe,CAACjB,MAAMiB,MAAtB;AACH,aAJD;AAKH,SA7CE;AA8CHU;AA9CG,KAAP;AA2DH;;AAED5B,YAAY6B,OAAZ,GAAsB,EAAtB","file":"maDateField.js","sourcesContent":["/**\n * Edition field for a date - a text input with a datepicker.\n *\n * @example <ma-date-field field=\"field\" value=\"value\"></ma-date-field>\n */\nexport default function maDateField() {\n    return {\n        scope: {\n            'field': '&',\n            'value': '='\n        },\n        restrict: 'E',\n        link: function(scope, element) {\n            var field = scope.field();\n            scope.name = field.name();\n            scope.rawValue = scope.value == null ? null : (scope.value instanceof Date ? scope.value : new Date(scope.value));\n\n            scope.$watch('rawValue', function(newValue) {\n                scope.value = field.parse()(newValue);\n            });\n\n            scope.$watch('value', (newValue, oldValue) => {\n                if (newValue === oldValue) {\n                    return;\n                }\n\n                if (!newValue) {\n                    scope.rawValue = null;\n                    return;\n                }\n\n                scope.rawValue = scope.value instanceof Date ? scope.value : new Date(scope.value);\n            });\n\n            scope.format = field.format();\n            if (!scope.format) {\n                scope.format = field.type() === 'date' ? 'yyyy-MM-dd' : 'yyyy-MM-dd HH:mm:ss';\n            }\n\n            scope.v = field.validation();\n            scope.isOpen = false;\n            var input = element.find('input').eq(0);\n            var attributes = field.attributes();\n            for (var name in attributes) {\n                input.attr(name, attributes[name]);\n            }\n            scope.toggleDatePicker = function ($event) {\n                $event.preventDefault();\n                $event.stopPropagation();\n                scope.isOpen = !scope.isOpen;\n            };\n        },\n        template:\n`<div class=\"input-group datepicker\">\n    <input\n        type=\"text\" ng-model=\"rawValue\" id=\"{{ name }}\" name=\"{{ name }}\" class=\"form-control\"\n        uib-datepicker-popup=\"{{ format }}\" is-open=\"isOpen\" ng-required=\"v.required\"\n        close-text=\"{{ 'CLOSE' | translate }}\" clear-text=\"{{ 'CLEAR' | translate }}\" current-text=\"{{ 'CURRENT' | translate }}\"/>\n    <span class=\"input-group-btn\">\n        <button type=\"button\" class=\"btn btn-default\" ng-click=\"toggleDatePicker($event)\">\n            <i class=\"glyphicon glyphicon-calendar\"></i>\n        </button>\n    </span>\n</div>`\n    };\n}\n\nmaDateField.$inject = [];\n"]}